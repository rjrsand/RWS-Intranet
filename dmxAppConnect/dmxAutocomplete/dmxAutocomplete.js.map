{"version":3,"sources":["components/autocomplete.js"],"names":["dmx","Component","extends","initialData","selectedItem","attributes","data","type","Array","default","matchcase","Boolean","matchstart","matchaccent","optiontext","String","optionvalue","optionsearch","noresultslabel","placeholder","noclear","events","noresults","Event","init","node","this","_keydownHandler","bind","_mousedownHandler","_data","_selectedIndex","_input","cloneNode","removeAttribute","setAttribute","prototype","call","addEventListener","_inputHandler","_changeHandler","_focusHandler","_blurHandler","style","setProperty","parentNode","insertBefore","destroy","removeEventListener","_list","_hideList","remove","$node","removeProperty","render","document","createElement","name","classList","add","performUpdate","Map","updatedProps","has","repeatItems","props","map","item","index","label","parse","DataScope","value","search","_setValue","defaultValue","event","find","set","dispatchEvent","nextTick","_focus","focus","_disable","disable","disabled","_updateList","i","html","_matches","_htmlEncode","_htmlItem","innerHTML","_showList","_updateActive","nodes","children","length","from","forEach","id","itemTop","offsetTop","itemHeight","offsetHeight","listTop","scrollTop","listHeight","str","re","RegExp","escapeRegExp","replace","m","_normalize","toLowerCase","substring","includes","normalize","result","split","c","charCodeAt","fromCharCode","join","offsetLeft","clear","key","preventDefault","MouseEvent","bubbles","stopPropagation","target","contains","getAttribute","select","_resetHandler"],"mappings":"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","file":"dmxAutocomplete.js","sourcesContent":["dmx.Component('autocomplete', {\r\n\r\n  extends: 'form-element',\r\n\r\n  initialData: {\r\n    selectedItem: null,\r\n  },\r\n\r\n  attributes: {\r\n    data: {\r\n      type: Array,\r\n      default: [],\r\n    },\r\n\r\n    matchcase: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n\r\n    matchstart: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n\r\n    matchaccent: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n\r\n    optiontext: {\r\n      type: String,\r\n      default: '$value',\r\n    },\r\n\r\n    optionvalue: {\r\n      type: String,\r\n      default: '$value',\r\n    },\r\n\r\n    optionsearch: {\r\n      type: String,\r\n      default: null,\r\n    },\r\n\r\n    noresultslabel: {\r\n      type: String,\r\n      default: 'No Results...',\r\n    },\r\n\r\n    placeholder: {\r\n      type: String,\r\n      default: '',\r\n    },\r\n\r\n    noclear: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n  },\r\n\r\n  events: {\r\n    noresults: Event,\r\n  },\r\n\r\n  init (node) {\r\n    this._keydownHandler = this._keydownHandler.bind(this);\r\n    this._mousedownHandler = this._mousedownHandler.bind(this);\r\n\r\n    this._data = [];\r\n    this._selectedIndex = -1;\r\n\r\n    this._input = node.cloneNode();\r\n    this._input.removeAttribute('id');\r\n    this._input.removeAttribute('name');\r\n    this._input.setAttribute('form', '__dummy__');\r\n    this._input.setAttribute('autocomplete', 'off');\r\n\r\n    dmx.Component('form-element').prototype.init.call(this, node);\r\n\r\n    this._input.addEventListener('keydown', this._keydownHandler);\r\n    this._input.addEventListener('input', this._inputHandler);\r\n    this._input.addEventListener('change', this._changeHandler);\r\n    this._input.addEventListener('focus', this._focusHandler);\r\n    this._input.addEventListener('blur', this._blurHandler);\r\n\r\n    node.style.setProperty('display', 'none');\r\n    node.parentNode.insertBefore(this._input, node);\r\n  },\r\n\r\n  destroy () {\r\n    dmx.Component('form-element').prototype.destroy.call(this);\r\n\r\n    this._input.removeEventListener('keydown', this._keydownHandler);\r\n    this._list.removeEventListener('mousedown', this._mousedownHandler);\r\n    this._hideList(true);\r\n    this._input.remove();\r\n    this.$node.style.removeProperty('display');\r\n  },\r\n\r\n  render (node) {\r\n    this._list = document.createElement('div');\r\n    this._list.setAttribute('id', this.name + '-list');\r\n    this._list.classList.add('dmx-autocomplete-items');\r\n    this._list.addEventListener('mousedown', this._mousedownHandler);\r\n\r\n    // Aria\r\n    this._input.setAttribute('role', 'combobox');\r\n    this._input.setAttribute('aria-autocomplete', 'list');\r\n    this._input.setAttribute('aria-controls', this.name + '-list');\r\n    this._input.setAttribute('aria-expanded', 'false');\r\n\r\n    this._list.setAttribute('role', 'listbox');\r\n\r\n    this.performUpdate(new Map([['data', true]]));\r\n  },\r\n\r\n  performUpdate (updatedProps) {\r\n    if (updatedProps.has('data') || updatedProps.has('optiontext') || updatedProps.has('optionvalue') || updatedProps.has('optionsearch')) {\r\n      this._data = dmx.repeatItems(this.props.data).map((item, index) => {\r\n        const label = dmx.parse(this.props.optiontext, dmx.DataScope(item, this));\r\n        const value = dmx.parse(this.props.optionvalue, dmx.DataScope(item, this));\r\n        const search = this.props.optionsearch ? dmx.parse(this.props.optionsearch, dmx.DataScope(item, this)) : label;\r\n        return { index, label, value, search, item };\r\n      });\r\n      this._setValue(this.props.value, true);\r\n    }\r\n\r\n    dmx.Component('form-element').prototype.performUpdate.call(this, updatedProps);\r\n  },\r\n  \r\n  _setValue (value, defaultValue, event) {\r\n    const selectedItem = this._data.find(item => item.value == value);\r\n\r\n    this._input.value = selectedItem ? selectedItem.label : '';\r\n    this.$node.value = selectedItem ? selectedItem.value : '';\r\n\r\n    if (defaultValue) {\r\n      this._input.defaultValue = this._input.value;\r\n      this.$node.defaultValue = this.$node.value;\r\n    }\r\n\r\n    this.set('value', this.$node.value);\r\n    if (event) this.dispatchEvent('changed');\r\n    dmx.nextTick(() => this.dispatchEvent(\"updated\"));\r\n  },\r\n\r\n  _focus () {\r\n    this._input.focus();\r\n  },\r\n\r\n  _disable (disable) {\r\n    this._input.disabled = disable;\r\n    dmx.Component('form-element').prototype._disable.call(this, disable);\r\n  },\r\n\r\n  _updateList () {\r\n    const value = this._input.value;\r\n\r\n    let i = 0;\r\n    let html = '';\r\n\r\n    if (value) {\r\n      for (const item of this._data) {\r\n        if (this._matches(item.search, value)) {\r\n          html += `<div id=\"${this.name}-option-${++i}\" class=\"dmx-autocomplete-item\" value=\"${this._htmlEncode(item.value)}\" role=\"option\">${this._htmlItem(item.label, value)}</div>`;\r\n        }\r\n      }\r\n\r\n      if (html === '') {\r\n        html = `<div class=\"dmx-autocomplete-item dmx-autocomplete-noresults\" role=\"option\">${this.props.noresultslabel}</div>`;\r\n      }\r\n    }\r\n\r\n    this._selectedIndex = -1;\r\n    this._list.innerHTML = html;\r\n\r\n    if (value) {\r\n      this._showList();\r\n    } else {\r\n      this._hideList();\r\n    }\r\n  },\r\n\r\n  _updateActive () {\r\n    const nodes = this._list.children;\r\n\r\n    if (this._selectedIndex >= nodes.length) this._selectedIndex = 0;\r\n    if (this._selectedIndex < 0) this._selectedIndex = nodes.length - 1;\r\n\r\n    Array.from(nodes).forEach((node, index) => {\r\n      if (index === this._selectedIndex) {\r\n        node.classList.add('dmx-autocomplete-active');\r\n        node.setAttribute('aria-selected', 'true');\r\n        if (node.id) {\r\n          this._input.setAttribute('aria-activedescendant', node.id);\r\n        }\r\n      } else {\r\n        node.classList.remove('dmx-autocomplete-active');\r\n        node.removeAttribute('aria-selected');\r\n      }\r\n    });\r\n\r\n    const itemTop = nodes[this._selectedIndex].offsetTop;\r\n    const itemHeight = nodes[this._selectedIndex].offsetHeight;\r\n    const listTop = this._list.scrollTop;\r\n    const listHeight = this._list.offsetHeight;\r\n\r\n    if (itemTop < listTop) {\r\n      this._list.scrollTop = itemTop;\r\n    } else if (itemTop + itemHeight > listTop + listHeight) {\r\n      this._list.scrollTop = itemTop + itemHeight - listHeight;\r\n    }\r\n  },\r\n\r\n  _htmlItem (str, value) {\r\n    let html = this._htmlEncode(str);\r\n    let re = new RegExp((this.props.matchstart ? '^' : '') + dmx.escapeRegExp(this._htmlEncode(value), this.props.matchcase ? 'g' : 'gi'));\r\n    return html.replace(re, m => `<b>${m}</b>`);\r\n  },\r\n\r\n  _htmlEncode (str) {\r\n    return String(str).replace(/&/g, '&amp;').replace(/\"/g, '&quot;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\r\n  },\r\n\r\n  _matches (search, value) {\r\n    if (!search) return false;\r\n\r\n    if (!this.props.matchaccent) {\r\n      search = this._normalize(search);\r\n      value = this._normalize(value);\r\n    }\r\n\r\n    if (!this.props.matchcase) {\r\n      search = search.toLowerCase();\r\n      value = value.toLowerCase();\r\n    }\r\n\r\n    if (this.props.matchstart) {\r\n      search = search.substring(0, value.length);\r\n    }\r\n\r\n    return search.includes(value);\r\n  },\r\n\r\n  _normalize (str) {\r\n    if (str.normalize) {\r\n      return str.normalize('NFD').replace(/[\\u0300-\\u036f]/g, '');\r\n    }\r\n\r\n    const TAB_00C0 = 'AAAAAAACEEEEIIIIDNOOOOO*OUUUUYIsaaaaaaaceeeeiiii?nooooo/ouuuuy?yAaAaAaCcCcCcCcDdDdEeEeEeEeEeGgGgGgGgHhHhIiIiIiIiIiJjJjKkkLlLlLlLlLlNnNnNnnNnOoOoOoOoRrRrRrSsSsSsSsTtTtTtUuUuUuUuUuUuWwYyYZzZzZzF';\r\n    const result = str.split('');\r\n\r\n    for (const i = 0; i < result.length; i++) {\r\n      const c = str.charCodeAt(i);\r\n      if (c >= 0x00c0 && c <= 0x017f) {\r\n        result[i] = String.fromCharCode(TAB_00C0.charCodeAt(c - 0x00c0));\r\n      } else if (c > 127) {\r\n        result[i] = '?';\r\n      }\r\n    }\r\n\r\n    return result.join('');\r\n  },\r\n\r\n  _showList () {\r\n    if (this._list.innerHTML === '') return;\r\n    this._list.style.setProperty('left', this._input.offsetLeft + 'px');\r\n    this._list.style.setProperty('top', (this._input.offsetTop + this._input.offsetHeight) + 'px');\r\n    if (!this._list.parentNode) {\r\n      this.$node.parentNode.insertBefore(this._list, this.$node);\r\n      this._input.setAttribute('aria-expanded', 'true');\r\n    }\r\n  },\r\n\r\n  _hideList (clear) {\r\n    this._list.remove();\r\n    this._input.setAttribute('aria-expanded', 'false');\r\n    this._input.setAttribute('aria-activedescendant', '');\r\n    if (clear) {\r\n      this._list.innerHTML = '';\r\n    }\r\n  },\r\n\r\n  _keydownHandler (event) {\r\n    switch (event.key) {\r\n      case 'ArrowDown':\r\n        event.preventDefault();\r\n        this._selectedIndex++;\r\n        this._updateActive();\r\n        this._showList();\r\n        break;\r\n\r\n      case 'ArrowUp':\r\n        event.preventDefault();\r\n        this._selectedIndex--;\r\n        this._updateActive();\r\n        this._showList();\r\n        break;\r\n\r\n      case 'Escape':\r\n        event.preventDefault();\r\n        this._selectedIndex = -1;\r\n        this._hideList();\r\n        break;\r\n\r\n      case 'Enter':\r\n        event.preventDefault();\r\n        if (this._selectedIndex > -1) {\r\n          this._list.children[this._selectedIndex].dispatchEvent(new MouseEvent('mousedown', { bubbles: true }));\r\n        }\r\n        break;\r\n    }\r\n  },\r\n\r\n  _mousedownHandler (event) {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n    \r\n    if (event.target.classList.contains('dmx-autocomplete-noresults')) {\r\n      this.dispatchEvent('noresults');\r\n    } else {\r\n      this._setValue(event.target.getAttribute('value'), false, event);\r\n      this._input.select();\r\n      this._hideList();\r\n    }\r\n  },\r\n\r\n  _inputHandler (event) {\r\n    this._updateList();\r\n  },\r\n\r\n  _focusHandler (event) {\r\n    this._input.select();\r\n\r\n    this._showList();\r\n\r\n    dmx.Component('form-element').prototype._focusHandler.call(this, event);\r\n  },\r\n\r\n  _blurHandler (event) {\r\n    const found = this._data.find(item => item.label == this._input.value);\r\n\r\n    if (!found) {\r\n      if (this.props.noclear) {\r\n        this.$node.value = this._input.value;\r\n      } else {\r\n        this._setValue('', false, event);\r\n      }\r\n    }\r\n\r\n    this._hideList(true);\r\n\r\n    dmx.Component('form-element').prototype._blurHandler.call(this, event);\r\n  },\r\n\r\n  _resetHandler (event) {\r\n    this._input.value = this._input.defaultValue;\r\n    this.$node.value = this.$node.defaultValue;\r\n    dmx.Component('form-element').prototype._resetHandler.call(this, event);\r\n  },\r\n\r\n});\r\n"]}